# ERD Диаграмма для интернет-магазина российских кроссовок

## Концептуальная схема базы данных

```mermaid
erDiagram
    РЕГИОН {
        int id_региона PK
        varchar название_региона
        varchar код_региона
    }
    
    НАСЕЛЕННЫЙ_ПУНКТ {
        int id_населенного_пункта PK
        int id_региона FK
        varchar название_населенного_пункта
        varchar тип_населенного_пункта
    }
    
    УЛИЦА {
        int id_улицы PK
        int id_населенного_пункта FK
        varchar название_улицы
        varchar тип_улицы
    }
    
    АДРЕС {
        int id_адреса PK
        int id_улицы FK
        varchar номер_дома
        varchar квартира
        varchar почтовый_индекс
    }
    
    ПЕРСОНА {
        int id_персоны PK
        varchar фамилия
        varchar имя
        varchar отчество
        varchar телефон
        varchar email
        int id_адреса FK
        date дата_регистрации
        boolean активна
    }
    
    КЛИЕНТ {
        int id_клиента PK
        int id_персоны FK
        varchar номер_карты_лояльности
        decimal скидка_процент
        varchar предпочтения
        text примечания
    }
    
    ПОСТАВЩИК {
        int id_поставщика PK
        varchar название_компании
        varchar контактное_лицо
        varchar телефон
        varchar email
        int id_адреса FK
        varchar инн
        varchar кпп
        date дата_регистрации
        boolean активен
    }
    
    СОТРУДНИК {
        int id_сотрудника PK
        int id_персоны FK
        varchar должность
        varchar профессия
        varchar разряд_класс
        varchar структурное_подразделение
        date дата_приема
        decimal оклад
        decimal надбавки
        decimal премии
        varchar режим_работы
        varchar особенности_рабочего_времени
        int ежегодный_отпуск_дней
        varchar испытательный_срок
        varchar социально_бытовые_условия
        boolean активен
    }
    
    ТОВАР {
        int id_товара PK
        int id_поставщика FK
        varchar название_товара
        varchar бренд
        varchar модель
        varchar цвет
        varchar размер
        varchar материал
        decimal цена
        int количество_на_складе
        varchar описание
        boolean доступен
        date дата_создания
    }
    
    ЗАКАЗ {
        int id_заказа PK
        int id_клиента FK
        int id_сотрудника FK
        date дата_заказа
        varchar статус_заказа
        varchar способ_оплаты
        varchar способ_доставки
        decimal общая_сумма
        varchar примечания
    }
    
    ПОЗИЦИЯ_ЗАКАЗА {
        int id_позиции_заказа PK
        int id_заказа FK
        int id_товара FK
        int количество
        decimal цена_за_единицу
        decimal общая_цена
    }
    
    ДОГОВОР_С_ПОСТАВЩИКОМ {
        int id_договора PK
        int id_поставщика FK
        int id_сотрудника FK
        varchar номер_договора
        date дата_договора
        date дата_начала
        date дата_окончания
        decimal сумма_договора
        varchar статус_договора
        text условия_договора
        varchar периодичность_поставки
        varchar график_поставки
        varchar способ_поставки
        varchar вид_транспорта
        varchar переход_рисков
        varchar порядок_расчетов
        varchar форма_оплаты
        varchar срок_оплаты
        boolean счет_фактура_требуется
    }
    
    ТРУДОВОЙ_ДОГОВОР {
        int id_договора PK
        int id_сотрудника FK
        int id_руководителя FK
        varchar номер_договора
        date дата_договора
        date дата_начала
        date дата_окончания
        varchar должность
        varchar профессия
        varchar разряд_класс
        varchar структурное_подразделение
        decimal оклад
        decimal надбавки
        decimal премии
        varchar режим_работы
        varchar особенности_рабочего_времени
        int ежегодный_отпуск_дней
        varchar испытательный_срок
        varchar социально_бытовые_условия
        varchar ответственность_сторон
        varchar статус_договора
        text условия_договора
    }
    
    ПРИХОДНО_РАСХОДНАЯ_НАКЛАДНАЯ {
        int id_накладной PK
        int id_поставщика FK
        int id_сотрудника FK
        varchar номер_накладной
        date дата_накладной
        date дата_поступления
        decimal общая_сумма
        varchar статус_накладной
        text примечания
    }
    
    ПОЗИЦИЯ_НАКЛАДНОЙ {
        int id_позиции_накладной PK
        int id_накладной FK
        int id_товара FK
        int количество
        decimal цена_за_единицу
        decimal общая_цена
    }
    
    ЭЛЕКТРОННЫЙ_ЧЕК {
        int id_чека PK
        int id_заказа FK
        int id_сотрудника FK
        varchar номер_чека
        date дата_чека
        decimal общая_сумма
        varchar статус_оплаты
        varchar фискальные_данные
    }
    
    СЧЕТ_ФАКТУРА {
        int id_счета_фактуры PK
        int id_договора FK
        int id_поставщика FK
        varchar номер_счета_фактуры
        date дата_счета_фактуры
        decimal сумма_без_ндс
        decimal сумма_ндс
        decimal общая_сумма
        varchar статус_оплаты
        date дата_оплаты
        varchar способ_оплаты
    }
    
    %% Связи между сущностями
    РЕГИОН ||--o{ НАСЕЛЕННЫЙ_ПУНКТ : "содержит"
    НАСЕЛЕННЫЙ_ПУНКТ ||--o{ УЛИЦА : "содержит"
    УЛИЦА ||--o{ АДРЕС : "содержит"
    
    АДРЕС ||--o{ ПЕРСОНА : "имеет"
    АДРЕС ||--o{ ПОСТАВЩИК : "имеет"
    
    ПЕРСОНА ||--o| КЛИЕНТ : "может_быть"
    ПЕРСОНА ||--o| СОТРУДНИК : "может_быть"
    
    ПОСТАВЩИК ||--o{ ТОВАР : "поставляет"
    ПОСТАВЩИК ||--o{ ДОГОВОР_С_ПОСТАВЩИКОМ : "заключает"
    ПОСТАВЩИК ||--o{ ПРИХОДНО_РАСХОДНАЯ_НАКЛАДНАЯ : "поставляет"
    
    КЛИЕНТ ||--o{ ЗАКАЗ : "делает"
    СОТРУДНИК ||--o{ ЗАКАЗ : "обрабатывает"
    СОТРУДНИК ||--o{ ДОГОВОР_С_ПОСТАВЩИКОМ : "заключает"
    СОТРУДНИК ||--o{ ТРУДОВОЙ_ДОГОВОР : "имеет"
    СОТРУДНИК ||--o{ ПРИХОДНО_РАСХОДНАЯ_НАКЛАДНАЯ : "принимает"
    СОТРУДНИК ||--o{ ЭЛЕКТРОННЫЙ_ЧЕК : "выдает"
    
    ЗАКАЗ ||--o{ ПОЗИЦИЯ_ЗАКАЗА : "содержит"
    ЗАКАЗ ||--|| ЭЛЕКТРОННЫЙ_ЧЕК : "генерирует"
    
    ТОВАР ||--o{ ПОЗИЦИЯ_ЗАКАЗА : "входит_в"
    ТОВАР ||--o{ ПОЗИЦИЯ_НАКЛАДНОЙ : "поступает"
    
    ПРИХОДНО_РАСХОДНАЯ_НАКЛАДНАЯ ||--o{ ПОЗИЦИЯ_НАКЛАДНОЙ : "содержит"
    
    ДОГОВОР_С_ПОСТАВЩИКОМ ||--o{ СЧЕТ_ФАКТУРА : "генерирует"
    ПОСТАВЩИК ||--o{ СЧЕТ_ФАКТУРА : "выставляет"
    
    СОТРУДНИК ||--o{ ТРУДОВОЙ_ДОГОВОР : "управляет"
```

## Описание связей:

### Основные сущности:
1. **Персона** - общая сущность для физических лиц (клиентов и сотрудников)
2. **Клиент** - покупатели кроссовок с дополнительными атрибутами лояльности
3. **Заказ** - заказы клиентов с товарами и обработкой сотрудником
4. **Поставщик** - российские производители кроссовок
5. **Сотрудник** - персонал компании с трудовыми атрибутами
6. **Товар** - кроссовки различных моделей от поставщиков

### Документооборот:
1. **Приходно-расходная накладная** - документ поступления товаров от поставщиков
2. **Трудовой договор** - документ найма сотрудников с детальными условиями работы
3. **Электронный чек** - документ продажи товара клиенту
4. **Договор с поставщиком** - документ сотрудничества с производителями, включая условия поставки
5. **Счет-фактура** - документ для учета НДС и расчетов с поставщиками

### Адресная структура:
- **Регион** → **Населенный пункт** → **Улица** → **Адрес**
- Позволяет гибко работать с адресами по всей России

### Новая архитектура с сущностью ПЕРСОНА:

#### Преимущества объединения:
- **Нормализация данных** - исключение дублирования персональных данных
- **Гибкость** - одна персона может быть одновременно клиентом и сотрудником
- **Централизованное управление** - все персональные данные в одном месте
- **Упрощение связей** - адрес привязан к персоне, а не к роли

#### Сущность ПЕРСОНА содержит:
- **Фамилия** - фамилия физического лица
- **Имя** - имя физического лица  
- **Отчество** - отчество физического лица
- **Телефон** - контактный телефон
- **Email** - электронная почта
- **Адрес** - связь с адресной структурой
- **Дата регистрации** - когда персона была добавлена в систему
- **Активна** - статус активности персоны

#### Специализированные сущности:

**КЛИЕНТ** (расширяет ПЕРСОНА):
- **Номер карты лояльности** - идентификатор программы лояльности
- **Скидка процент** - размер скидки для клиента
- **Предпочтения** - предпочтения в товарах
- **Примечания** - дополнительная информация о клиенте

**СОТРУДНИК** (расширяет ПЕРСОНА):
- **Должность** - текущая должность
- **Профессия** - конкретная профессия
- **Разряд/класс** - квалификационная категория
- **Структурное подразделение** - отдел работы
- **Дата приема** - когда был принят на работу
- **Оклад** - базовая зарплата
- **Надбавки** - дополнительные выплаты
- **Премии** - поощрительные выплаты
- **Режим работы** - график работы
- **Особенности рабочего времени** - ненормированный день
- **Ежегодный отпуск** - количество дней отпуска
- **Испытательный срок** - период испытания
- **Социально-бытовые условия** - условия труда
- **Активен** - статус работы сотрудника

### Дополнительные атрибуты документов:

#### Договор с поставщиком:
- **Периодичность поставки** - частота поставок (ежемесячно, ежеквартально и т.д.)
- **График поставки** - конкретные даты или периоды поставки
- **Способ поставки** - отгрузка, передача товаров
- **Вид транспорта** - автомобильный, железнодорожный и т.д.
- **Переход рисков** - момент перехода ответственности за товар
- **Порядок расчетов** - условия оплаты
- **Форма оплаты** - наличные, безналичные, предоплата
- **Срок оплаты** - период для оплаты
- **Счет-фактура требуется** - необходимость выписки счета-фактуры

#### Трудовой договор:
- **Профессия** - конкретная профессия работника
- **Разряд/класс** - квалификационная категория
- **Структурное подразделение** - отдел, где работает сотрудник
- **Оклад** - базовая заработная плата
- **Надбавки** - дополнительные выплаты
- **Премии** - поощрительные выплаты
- **Режим работы** - график работы
- **Особенности рабочего времени** - ненормированный день, смены
- **Ежегодный отпуск** - количество дней отпуска
- **Испытательный срок** - период испытания
- **Социально-бытовые условия** - условия труда
- **Ответственность сторон** - обязательства работника и работодателя

#### Счет-фактура:
- **Сумма без НДС** - стоимость товаров без налога
- **Сумма НДС** - размер налога на добавленную стоимость
- **Общая сумма** - итоговая сумма к оплате
- **Статус оплаты** - оплачен/не оплачен
- **Дата оплаты** - когда был произведен платеж
- **Способ оплаты** - как был произведен платеж

